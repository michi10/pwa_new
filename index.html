<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
  <title>CWS – Wetter</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#2380cf" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="mobile-web-app-capable" content="yes" />

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
        referrerpolicy="no-referrer" />

  <!-- Styles -->
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- Splash (leicht animiert, barrierearm) -->
  <div id="splash" aria-live="polite" class="splash visible" data-i18n-aria-label="loading">
    <img src="assets/icon-192.png" alt="CWS Logo" width="128" height="128" />
    <p id="splashText" data-i18n="splashLoading">App wird geladen…</p>
    <div class="spinner" id="progressSpinner" role="progressbar" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0" data-i18n-aria-label="progress"></div>
  </div>

  <!-- App-Header -->
  <header id="appHeader" class="app-header" data-i18n-aria-label="header">
    <h1 class="brand">CWS</h1>
    <div class="title-stack">
      <div class="title" id="pageTitle" data-i18n="titleDashboard">Dashboard</div>
      <div class="personal-badge" id="personalBadge" hidden></div>
    </div>
    <div class="station-picker">
      <label for="stationQuickSelect" class="station-label">
        <i class="fa-solid fa-tower-broadcast" aria-hidden="true"></i>
        <span data-i18n="stationQuickSelect">Station</span>
      </label>
      <select id="stationQuickSelect" data-i18n-aria-label="stationQuickSelect">
        <option value="" data-i18n="favoriteStationNone">Keine Auswahl</option>
      </select>
    </div>
    <button id="btnSettings" class="icon-btn" data-i18n-aria-label="openSettings">
      <i class="fa-solid fa-gear"></i>
    </button>
  </header>

  <!-- Hauptinhalt -->
  <main id="app" class="app" role="main" aria-live="polite"></main>

  <footer class="app-footer">
    <div class="footer-inner">
      <div class="footer-copy">
        <h2 class="footer-tagline" data-i18n="footerMotto">Gemeinsam durch jede Wetterlage.</h2>
        <p class="footer-greeting" id="footerGreeting" data-i18n="footerGreetingDefault">Bleib neugierig auf den Himmel über dir.</p>
      </div>
      <div class="footer-actions">
        <button class="footer-btn" data-legal="privacy" data-i18n="footerPrivacy">Datenschutz</button>
        <button class="footer-btn" data-legal="imprint" data-i18n="footerImprint">Impressum</button>
        <button class="footer-btn" data-legal="terms" data-i18n="footerTerms">Nutzungsbedingungen</button>
      </div>
    </div>
  </footer>

  <!-- Bottom Nav -->
  <nav id="nav" class="nav" role="tablist" data-i18n-aria-label="navigation">
    <button class="nav-btn active" data-route="dashboard" role="tab" aria-selected="true" data-i18n-aria-label="navHome">
      <i class="fa-solid fa-house"></i><span data-i18n="navHome">Home</span>
    </button>
    <button class="nav-btn" data-route="map" role="tab" aria-selected="false" data-i18n-aria-label="navMap">
      <i class="fa-solid fa-map"></i><span data-i18n="navMap">Karte</span>
    </button>
    <button class="nav-btn" data-route="calendar" role="tab" aria-selected="false" data-i18n-aria-label="navCalendar">
      <i class="fa-solid fa-calendar"></i><span data-i18n="navCalendar">Kalender</span>
    </button>
    <button class="nav-btn" data-route="rain" role="tab" aria-selected="false" data-i18n-aria-label="navRain">
      <i class="fa-solid fa-cloud-rain"></i><span data-i18n="navRain">Regen</span>
    </button>
    <button class="nav-btn" data-route="insights" role="tab" aria-selected="false" data-i18n-aria-label="navInsights">
      <i class="fa-solid fa-chart-simple"></i><span data-i18n="navInsights">Analysen</span>
    </button>
  </nav>

  <!-- Settings-Dialog (AA/AAA-konform) -->
  <dialog id="settings" class="modal" aria-modal="true" data-i18n-aria-label="settings">
    <form method="dialog" class="card">
      <header class="card-head">
        <h2 data-i18n="settings">Einstellungen</h2>
        <button class="icon-btn" value="cancel" data-i18n-aria-label="close">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </header>

      <div class="card-body">
        <fieldset class="group">
          <legend data-i18n="appearance">Darstellung</legend>
          <label class="row">
            <input type="checkbox" id="darkToggle" />
            <span data-i18n="darkMode">Dark Mode aktivieren</span>
          </label>
          <label class="row">
            <input type="checkbox" id="reduceMotion" />
            <span data-i18n="reduceMotion">Animationen reduzieren</span>
          </label>
          <label class="row">
            <input type="checkbox" id="highContrast" />
            <span data-i18n="highContrast">Hohen Kontrast (AAA) aktivieren</span>
          </label>
        </fieldset>

        <fieldset class="group">
          <legend data-i18n="personalization">Personalisierung</legend>
          <div class="row">
            <input id="firstName" data-i18n-placeholder="firstName" placeholder="Vorname" autocomplete="given-name" aria-label="Vorname" data-i18n-aria-label="firstName" />
            <input id="lastName" data-i18n-placeholder="lastName" placeholder="Nachname" autocomplete="family-name" aria-label="Nachname" data-i18n-aria-label="lastName" />
          </div>
          <p class="hint" data-i18n="nameHint">Dein Name erscheint an mehreren Stellen (z. B. „Guten Morgen, Michael“).</p>
          <label class="row">
            <span data-i18n="language">Sprache</span>
            <select id="language">
              <option value="de">Deutsch</option>
              <option value="en">English</option>
            </select>
          </label>
        </fieldset>

        <fieldset class="group">
          <legend data-i18n="generalSettings">Allgemein</legend>
          <label class="row">
            <input type="checkbox" id="notifyToggle" />
            <span data-i18n="notifications">Benachrichtigungen zu Wetterereignissen</span>
          </label>
          <label class="row">
            <input type="checkbox" id="autoRefreshToggle" />
            <span data-i18n="autoRefresh">Daten automatisch aktualisieren</span>
          </label>
          <label class="row">
            <span data-i18n="refreshInterval">Intervall</span>
            <select id="refreshInterval">
              <option value="2" data-i18n="refreshInterval2">Alle 2 Minuten</option>
              <option value="5" data-i18n="refreshInterval5">Alle 5 Minuten</option>
              <option value="15" data-i18n="refreshInterval15">Alle 15 Minuten</option>
            </select>
          </label>
          <label class="row">
            <span data-i18n="measurementUnits">Einheiten</span>
            <select id="units">
              <option value="metric" data-i18n="unitsMetric">Metrisch (°C, km/h)</option>
              <option value="imperial" data-i18n="unitsImperial">Imperial (°F, mph)</option>
            </select>
          </label>
          <label class="row">
            <span data-i18n="favoriteStation">Lieblingsstation</span>
            <select id="favoriteStation"></select>
          </label>
        </fieldset>

        <fieldset class="group">
          <legend data-i18n="dataSource">Datenquelle</legend>
          <p class="hint" data-i18n="dataHint">Aktuell werden Demodaten verwendet. Später wird hier ThingsBoard verbunden.</p>
        </fieldset>
      </div>

      <footer class="card-foot">
        <button class="btn primary" id="saveSettings" value="default" data-i18n="save">Speichern</button>
      </footer>
    </form>
  </dialog>

  <dialog id="legalDialog" class="modal legal-modal" aria-modal="true">
    <form method="dialog" class="card">
      <header class="card-head">
        <h2 id="legalTitle">Rechtliches</h2>
        <button class="icon-btn" value="cancel" data-i18n-aria-label="close">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </header>
      <div class="card-body legal-body" id="legalContent"></div>
      <footer class="card-foot">
        <button class="btn primary" value="default" data-i18n="close">Schließen</button>
      </footer>
    </form>
  </dialog>

  <dialog id="metricDialog" class="modal metric-modal" aria-modal="true" data-i18n-aria-label="metricDetailsAria">
    <form method="dialog" class="card">
      <header class="card-head">
        <h2 id="metricDialogTitle" data-i18n="metricDetailsTitle">Messwert-Details</h2>
        <button class="icon-btn" value="cancel" data-i18n-aria-label="close">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </header>
      <div class="card-body metric-body">
        <p class="metric-subtitle" id="metricDialogSubtitle" hidden></p>
        <div class="metric-grid" id="metricDialogList"></div>
        <div class="metric-meta" id="metricDialogMeta"></div>
        <p class="metric-note" id="metricDialogNote" hidden></p>
        <p class="metric-empty" id="metricDialogEmpty" hidden data-i18n="metricDetailsNoData">Keine Detaildaten verfügbar.</p>
      </div>
      <footer class="card-foot metric-foot">
        <button class="btn primary" value="default" data-i18n="close">Schließen</button>
      </footer>
    </form>
  </dialog>

  <dialog id="accessGate" class="modal gate-modal" aria-modal="true" data-i18n-aria-label="accessTitle">
    <form method="dialog" class="card">
      <header class="card-head">
        <h2 data-i18n="accessTitle">Zugangscode</h2>
        <button class="icon-btn" value="cancel" data-i18n-aria-label="close">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </header>
      <div class="card-body gate-body">
        <p data-i18n="accessDescription">Bitte gib deinen persönlichen Zugangscode ein. Jeder Code kann nur drei Mal aktiviert werden.</p>
        <label class="gate-label">
          <span data-i18n="accessCodeLabel">Code</span>
          <input type="text" id="accessCode" inputmode="numeric" pattern="[0-9]*" maxlength="6" autocomplete="one-time-code" data-i18n-placeholder="accessCodePlaceholder" placeholder="123456" />
        </label>
        <p class="hint" id="accessHint" data-i18n="accessHint">Kontaktier uns, falls dein Code bereits verwendet wurde.</p>
        <p class="gate-error" id="accessError" role="alert"></p>
      </div>
      <footer class="card-foot gate-foot">
        <button class="btn" value="cancel" data-i18n="close">Schließen</button>
        <button class="btn primary" id="submitCode" value="default" data-i18n="accessConfirm">Freischalten</button>
      </footer>
    </form>
  </dialog>

  <!-- Daten & App -->
  <script src="data/demo.js"></script>
  <script src="app.js"></script>
</body>
</html>
